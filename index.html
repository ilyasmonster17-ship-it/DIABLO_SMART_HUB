<!DOCTYPE html>
<html lang="ar" dir="rtl" id="diablo-app">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Diablo Hub | New Generation</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>

<style>
:root { --p:#ff4500; --bg:#050505; --card:#111; --t:#fff; --border:#222; --gold:#ffd700; }
.light-mode { --bg:#f5f5f5; --card:#fff; --t:#222; --border:#ddd; }
body { margin:0; padding-bottom:100px; font-family:'Cairo',sans-serif; background:var(--bg); color:var(--t); overflow-x:hidden; }
header{padding:15px 5%; display:flex; justify-content:space-between; align-items:center; background:var(--card); border-bottom:1px solid var(--border); position:sticky; top:0; z-index:1000;}
.search-bar{flex:1; display:flex; background:var(--bg); border:1px solid var(--border); border-radius:20px; padding:5px 15px; margin:0 10px;}
.search-bar input{border:none; background:none; color:var(--t); outline:none; width:100%; font-size:14px;}
.categories{display:flex; overflow-x:auto; gap:10px; padding:10px 5%; white-space:nowrap;}
.cat-btn{background:var(--card); border:1px solid var(--border); color:var(--t); padding:8px 15px; border-radius:20px; cursor:pointer;}
.cat-btn.active{background:var(--p); border-color:var(--p); color:white;}
.publish-btn-main{position:fixed; bottom:30px; left:50%; transform:translateX(-50%); width:50px; height:40px; background:linear-gradient(90deg,#00f2ea 0%,#ff0050 100%); border-radius:12px; display:none; align-items:center; justify-content:center; z-index:9000; cursor:pointer; border:none;}
.publish-btn-main::after{content:'+'; color:black; font-size:25px; font-weight:bold; background:white; width:25px; height:25px; border-radius:5px; display:flex; align-items:center; justify-content:center;}
.post-card{background:var(--card); border:1px solid var(--border); border-radius:15px; margin:15px 5%; padding:15px; position:relative;}
.post-card.premium{border:2px solid var(--gold); box-shadow:0 0 15px rgba(255,215,0,0.2);}
.price-tag{position:absolute; top:10px; left:10px; background:#25d366; color:white; padding:3px 12px; border-radius:20px; font-weight:bold;}
.side-menu{position:fixed; top:0; right:-100%; width:280px; height:100%; background:var(--card); z-index:9500; transition:0.4s; padding:20px;}
.side-menu.active{right:0;}
.overlay{position:fixed; inset:0; background:rgba(0,0,0,0.8); display:none; z-index:9400;}
.btn{background:var(--p); color:white; border:none; padding:12px; border-radius:8px; cursor:pointer; font-weight:bold; width:100%; margin-top:10px;}
input,textarea,select{width:100%; padding:12px; margin:8px 0; border-radius:8px; border:1px solid var(--border); background:var(--bg); color:var(--t);}
.request-card{background:var(--card); border:2px solid var(--p); border-radius:15px; margin:10px 5%; padding:12px;}
</style>
</head>

<body>

<div id="startScreen">
<h1 style="color:var(--p)">DIABLO HUB</h1>
<p>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø£Ù‚ÙˆÙ‰ Ù…Ù†ØµØ© Ø¹Ù‚Ø§Ø±ÙŠØ©</p>
<button class="btn" onclick="setRole('seller')">Ø£Ù†Ø§ Ù…Ø§Ù„Ùƒ</button>
</div>

<div id="mainApp" style="display:none;">
<header>
<button onclick="toggleMenu()" style="background:none;border:none;color:var(--p);font-size:24px">â˜°</button>
<div class="search-bar"><input id="searchInput" oninput="filterPosts()" placeholder="Ø¨Ø­Ø«..."></div>
<button onclick="toggleTheme()" style="background:none;border:none;color:var(--p)"><i class="fas fa-moon"></i></button>
</header>

<div class="categories">
<button class="cat-btn active" onclick="setCat('Ø§Ù„ÙƒÙ„',this)">Ø§Ù„ÙƒÙ„</button>
<button class="cat-btn" onclick="setCat('Ø´Ù‚Ù‚',this)">Ø´Ù‚Ù‚</button>
<button class="cat-btn" onclick="setCat('ÙÙŠÙ„Ø§Øª',this)">ÙÙŠÙ„Ø§Øª</button>
<button class="cat-btn" onclick="setCat('Ù…Ù†Ø§Ø²Ù„',this)">Ù…Ù†Ø§Ø²Ù„</button>
</div>

<div id="cloudFeed"></div>
<div id="requestFeed"></div>
<button class="publish-btn-main" id="mainPublishBtn" onclick="openPublishModal(false)"></button>
</div>

<div id="publishModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.9);z-index:9999;align-items:center;justify-content:center">
<div style="background:var(--card);padding:20px;border-radius:20px;width:90%;max-width:400px">
<h3>Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù†</h3>
<input id="pTitle" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†">
<input id="pPrice" type="number" placeholder="Ø§Ù„Ø³Ø¹Ø±">
<textarea id="pDesc" placeholder="Ø§Ù„ÙˆØµÙ"></textarea>
<input id="pPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
<button class="btn" onclick="uploadToFirebase()">Ù†Ø´Ø±</button>
<button class="btn" style="background:#222" onclick="closePublishModal()">Ø¥Ù„ØºØ§Ø¡</button>
</div>
</div>

<div id="requestModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.9);z-index:9999;align-items:center;justify-content:center">
<div style="background:var(--card);padding:20px;border-radius:20px;width:90%;max-width:400px">
<h3>Ø·Ù„Ø¨ Ø¹Ù‚Ø§Ø±</h3>
<input id="rPrice" placeholder="Ø§Ù„Ø³Ø¹Ø±">
<input id="rCity" placeholder="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©">
<button class="btn" onclick="addRequest()">Ø¥Ø±Ø³Ø§Ù„</button>
<button class="btn" style="background:#222" onclick="closeRequestModal()">Ø¥Ù„ØºØ§Ø¡</button>
</div>
</div>

<div class="side-menu" id="sideMenu">
<button class="btn" onclick="openRequestModal()">ğŸ“© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>
<button class="btn" onclick="showPrivacy()">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</button>
</div>
<div class="overlay" id="mainOverlay" onclick="toggleMenu()"></div>

<script>
const firebaseConfig={apiKey:"AIzaSyCGWNteBBsejx6UISfvnTY1YmnQeom7vNg",authDomain:"daiblosmart.firebaseapp.com",projectId:"daiblosmart"};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();
let currentCat="Ø§Ù„ÙƒÙ„";

function setRole(){document.getElementById("startScreen").style.display="none";document.getElementById("mainApp").style.display="block";document.getElementById("mainPublishBtn").style.display="flex";loadCloudData();loadRequests();}
function toggleMenu(){sideMenu.classList.toggle("active");mainOverlay.style.display=sideMenu.classList.contains("active")?"block":"none";}
function toggleTheme(){document.body.classList.toggle("light-mode");}
function openPublishModal(){publishModal.style.display="flex";}
function closePublishModal(){publishModal.style.display="none";}
function openRequestModal(){requestModal.style.display="flex";}
function closeRequestModal(){requestModal.style.display="none";}
function showPrivacy(){alert("Ø®ØµÙˆØµÙŠØªÙƒ Ù…Ø­ÙÙˆØ¸Ø© 100Ùª");}

function uploadToFirebase(){
db.collection("posts").add({
title:pTitle.value,
price:pPrice.value,
desc:pDesc.value,
phone:pPhone.value,
time:Date.now()
}).then(()=>location.reload());
}

function loadCloudData(){
db.collection("posts").orderBy("time","desc").onSnapshot(s=>{
cloudFeed.innerHTML="";
s.forEach(d=>{
const p=d.data();
cloudFeed.innerHTML+=`<div class="post-card"><b>${p.title}</b><p>${p.price}$</p></div>`;
});
});
}

function addRequest(){
db.collection("requests").add({price:rPrice.value,city:rCity.value,time:Date.now()})
.then(()=>{closeRequestModal();alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨");});
}

function loadRequests(){
db.collection("requests").orderBy("time","desc").onSnapshot(s=>{
requestFeed.innerHTML="";
s.forEach(d=>{
const r=d.data();
requestFeed.innerHTML+=`<div class="request-card">${r.city} - ${r.price}$</div>`;
});
});
}
</script>

</body>
</html>
