<!DOCTYPE html>
<html lang="ar" dir="rtl" id="diablo-app">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Diablo Hub | AI Smart Management</title>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>

    <style>
        :root { --p: #ff4500; --bg: #050505; --card: #111; --t: #fff; --border: #222; }
        .light-mode { --bg: #f5f5f5; --card: #fff; --t: #222; --border: #ddd; }
        
        body { background: var(--bg); color: var(--t); font-family: 'Cairo', sans-serif; margin: 0; min-height: 100vh; overflow-x: hidden; padding-bottom: 100px; }
        header { padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; background: var(--card); border-bottom: 1px solid var(--border); sticky; top: 0; z-index: 1000; }
        
        /* Ø§Ù„Ø¨ÙˆØª ÙˆØ§Ù„ÙÙ‚Ø§Ø¹Ø© */
        #diablo-ai-bot { position: fixed; bottom: 110px; left: 20px; width: 55px; height: 55px; background: var(--p); border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 5000; cursor: pointer; border: 2px solid white; transition: 0.5s; }
        #bot-bubble { position: absolute; bottom: 65px; left: 0; width: 200px; background: var(--card); border: 1px solid var(--p); padding: 10px; border-radius: 10px; font-size: 12px; display: none; z-index: 5001; box-shadow: 0 5px 15px #000; }

        .page-content { padding: 15px 5%; display: none; width: 100%; box-sizing: border-box; }
        .post-card { background: var(--card); border: 1px solid var(--border); border-radius: 15px; margin-bottom: 20px; padding: 15px; position: relative; }
        .img-slider { display: flex; overflow-x: auto; gap: 10px; }
        .img-slider img { height: 180px; border-radius: 10px; }

        /* Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ± Ù…Ø¹ Ø²Ø± Ø§Ù„Ù…Ø³Ø­ */
        .pre-box { position: relative; display: inline-block; margin: 5px; }
        .pre-box img { width: 60px; height: 60px; border-radius: 5px; object-fit: cover; }
        .pre-box .del-img { position: absolute; top: -5px; right: -5px; background: red; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; }

        .side-menu { position: fixed; top: 0; right: -100%; width: 280px; height: 100%; background: var(--card); z-index: 3000; transition: 0.4s; padding: 20px; border-left: 1px solid var(--border); }
        .side-menu.active { right: 0; }
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); display: none; z-index: 2500; }

        .btn { background: var(--p); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 10px; }
        input, textarea, select { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid var(--border); background: var(--bg); color: var(--t); }
        
        .user-profile { text-align: center; padding: 10px; background: #1a1a1a; border-radius: 10px; margin-bottom: 15px; }
        .profile-img { width: 60px; height: 60px; border-radius: 50%; border: 2px solid var(--p); }

        .ads-footer { position: fixed; bottom: 0; left: 0; width: 100%; height: 85px; background: #000; border-top: 2px solid var(--p); display: flex; justify-content: space-around; align-items: center; z-index: 4000; }
        .ad-box { width: 30%; height: 60px; background: #111; font-size: 10px; color: #444; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div id="diablo-ai-bot" onclick="startGuide()">
    ğŸ¤–
    <div id="bot-bubble">Ø£Ù‡Ù„Ø§Ù‹! Ø£Ù†Ø§ Ø°ÙƒØ§Ø¡ Ø¯ÙŠØ§Ø¨Ù„Ùˆ. ÙƒÙŠÙ Ø£Ø³Ø§Ø¹Ø¯ÙƒØŸ</div>
</div>

<div class="overlay" id="overlay" onclick="toggleMenu()"></div>

<div class="side-menu" id="sideMenu">
    <div id="sideProfile" class="user-profile" style="display:none;">
        <img id="uPic" src="https://cdn-icons-png.flaticon.com/512/149/149071.png" class="profile-img">
        <div id="uName" style="font-weight:bold; margin-top:5px;">Ù…Ø³ØªØ®Ø¯Ù… Ø¯ÙŠØ§Ø¨Ù„Ùˆ</div>
        <button onclick="showPage('profile')" style="background:none; border:none; color:var(--p); font-size:12px; cursor:pointer;">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„</button>
    </div>
    <h2 style="color:var(--p)">DIABLO HUB</h2>
    <a href="#" onclick="showPage('home')" style="display:block; color:var(--t); padding:10px 0; text-decoration:none;">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    <a href="#" onclick="showPage('auth')" style="display:block; color:var(--t); padding:10px 0; text-decoration:none;" id="loginLink">ğŸ”‘ Ø¯Ø®ÙˆÙ„ / Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</a>
    <a href="#" onclick="showPage('favs')" style="display:block; color:var(--t); padding:10px 0; text-decoration:none;">â¤ï¸ Ø§Ù„Ù…ÙØ¶Ù„Ø©</a>
    <hr>
    <button class="btn" style="background:#333;" onclick="toggleMenu()">Ø¥ØºÙ„Ø§Ù‚</button>
    <button class="btn" id="logoutBtn" style="display:none; background:red; margin-top:20px;" onclick="auth.signOut().then(()=>location.reload())">Ø®Ø±ÙˆØ¬</button>
</div>

<header>
    <button onclick="toggleMenu()" style="background:none; border:none; color:var(--p); font-size:24px;">â˜°</button>
    <div style="font-weight:bold; color:var(--p); font-size:1.2rem;">DIABLO HUB</div>
    <button onclick="toggleTheme()" style="background:none; border:1px solid var(--p); color:var(--p); border-radius:20px; padding:4px 12px;">MODE</button>
</header>

<div id="homePage" class="page-content" style="display:block;">
    <div id="roleSelection" style="text-align:center; padding: 30px 0;">
        <button class="btn" id="goInv" onclick="showInvestors()">ğŸ“Š Ù‚Ø³Ù… Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†</button>
        <button class="btn" id="goSell" onclick="initApp('seller')" style="background:#222; border:1px solid var(--p);">ğŸ  Ù‚Ø³Ù… Ø§Ù„Ù…Ù„Ø§Ùƒ</button>
    </div>

    <div id="uploadArea" style="display:none; background:var(--card); padding:20px; border-radius:15px; border:1px solid var(--border); margin-bottom:20px;">
        <input type="text" id="pTitle" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†...">
        <textarea id="pDesc" rows="3" placeholder="Ø§Ù„ÙˆØµÙ (Ø§ÙƒØªØ¨ 'Ø³Ù„Ø§Ù…' Ù„Ù„Ø¨ÙˆØª)..." oninput="aiTalk(this.value)"></textarea>
        <input type="tel" id="pPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ...">
        <input type="file" id="pFiles" multiple accept="image/*" onchange="handleFiles(this.files)">
        <div id="preGrid" style="margin:10px 0;"></div>
        <button class="btn" onclick="uploadToFirebase()">Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</button>
    </div>
    <div id="cloudFeed"></div>
</div>

<div id="authPage" class="page-content">
    <div style="text-align:center; max-width:400px; margin:auto; background:var(--card); padding:20px; border-radius:15px;">
        <h3 id="authTitle">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ / Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
        <input type="email" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
        <input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <select id="avatarChoice">
            <option value="https://cdn-icons-png.flaticon.com/512/3135/3135715.png">Ø¨Ø±ÙˆÙØ§ÙŠÙ„ 1</option>
            <option value="https://cdn-icons-png.flaticon.com/512/4140/4140048.png">Ø¨Ø±ÙˆÙØ§ÙŠÙ„ 2</option>
            <option value="https://cdn-icons-png.flaticon.com/512/4140/4140047.png">Ø¨Ø±ÙˆÙØ§ÙŠÙ„ 3</option>
        </select>
        <button class="btn" onclick="handleAuth()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†</button>
    </div>
</div>

<div id="profilePage" class="page-content">
    <h3>ØªØ¹Ø¯ÙŠÙ„ Ø­Ø³Ø§Ø¨ÙŠ</h3>
    <input type="text" id="editName" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯">
    <button class="btn" onclick="updateProfile()">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
</div>

<div id="favsPage" class="page-content"><h2>â¤ï¸ Ø§Ù„Ù…ÙØ¶Ù„Ø©</h2></div>

<div class="ads-footer">
    <div class="ad-box">AD 1</div><div class="ad-box">AD 2</div><div class="ad-box">AD 3</div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCGWNteBBsejx6UISfvnTY1YmnQeom7vNg",
        authDomain: "daiblosmart.firebaseapp.com",
        projectId: "daiblosmart",
        storageBucket: "daiblosmart.firebasestorage.app",
        messagingSenderId: "948075676362",
        appId: "1:948075676362:web:c27d582068712cbe13aa33"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();
    let tempImgs = [], isAdmin = false;

    // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    auth.onAuthStateChanged(user => {
        if (user) {
            document.getElementById('sideProfile').style.display = 'block';
            document.getElementById('logoutBtn').style.display = 'block';
            document.getElementById('loginLink').style.display = 'none';
            document.getElementById('uName').innerText = user.displayName || user.email;
            document.getElementById('uPic').src = user.photoURL || "https://cdn-icons-png.flaticon.com/512/149/149071.png";
            if(user.email === "diablo@admin.com") isAdmin = true;
            loadCloudData();
        }
    });

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø¯Ù…Ø¬
    function handleAuth() {
        const e = document.getElementById('email').value, p = document.getElementById('pass').value, av = document.getElementById('avatarChoice').value;
        auth.signInWithEmailAndPassword(e, p).then(() => {
            showPage('home');
        }).catch(() => {
            auth.createUserWithEmailAndPassword(e, p).then(res => {
                res.user.updateProfile({ photoURL: av });
                showPage('home');
            });
        });
    }

    // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„
    function updateProfile() {
        const n = document.getElementById('editName').value;
        auth.currentUser.updateProfile({ displayName: n }).then(() => {
            alert("ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«!");
            location.reload();
        });
    }

    // Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ù…Ø±Ø´Ø¯
    function startGuide() {
        const bot = document.getElementById('diablo-ai-bot');
        const bub = document.getElementById('bot-bubble');
        bub.style.display = "block";
        
        const target = document.getElementById('goInv').getBoundingClientRect();
        bot.style.transform = `translate(${target.left - 20}px, ${target.top - bot.offsetTop - 60}px)`;
        bub.innerText = "Ù‡Ù†Ø§ Ù‚Ø³Ù… Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ† Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø¹Ø±ÙˆØ¶!";

        setTimeout(() => {
            bot.style.transform = "translate(0,0)";
            bub.innerText = "ØªØ­Ø¯Ø« Ù…Ø¹ÙŠ ÙÙŠ Ø®Ø§Ù†Ø© Ø§Ù„ÙˆØµÙ Ø¥Ø°Ø§ Ø§Ø­ØªØ¬Øª Ù…Ø³Ø§Ø¹Ø¯Ø©!";
            setTimeout(() => bub.style.display="none", 3000);
        }, 4000);
    }

    function aiTalk(v) {
        const bub = document.getElementById('bot-bubble');
        bub.style.display = "block";
        const t = v.toLowerCase();
        if(t.includes("Ø³Ù„Ø§Ù…")) bub.innerText = "ÙˆØ¹Ù„ÙŠÙƒÙ… Ø§Ù„Ø³Ù„Ø§Ù… ÙŠØ§ Ø¯ÙŠØ§Ø¨Ù„Ùˆ! ÙƒÙŠÙ Ø­Ø§Ù„ÙƒØŸ";
        else if(t.includes("Ø³Ø¹Ø±")) bub.innerText = "Ù†ØµÙŠØ­Ø©: Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø¨Ø³Ø¹Ø± Ø¬ÙŠØ¯ ØªØ¸Ù‡Ø± Ø£ÙˆÙ„Ø§Ù‹!";
        else bub.innerText = "Ø£Ù†Ø§ Ø£Ø³Ù…Ø¹Ùƒ.. Ø£ÙƒÙ…Ù„!";
    }

    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ± ÙˆÙ…Ø³Ø­Ù‡Ø§
    function handleFiles(files) {
        Array.from(files).forEach(f => {
            const r = new FileReader();
            r.onload = e => {
                const id = Date.now() + Math.random();
                tempImgs.push({src: e.target.result, id: id});
                renderPre();
            };
            r.readAsDataURL(f);
        });
    }

    function renderPre() {
        document.getElementById('preGrid').innerHTML = tempImgs.map(i => `
            <div class="pre-box">
                <img src="${i.src}">
                <button class="del-img" onclick="removeImg(${i.id})">âœ•</button>
            </div>
        `).join('');
    }

    function removeImg(id) { tempImgs = tempImgs.filter(i => i.id !== id); renderPre(); }

    // Ø§Ù„Ø±ÙØ¹ ÙˆØ§Ù„Ø­Ø°Ù (Ù„Ù„Ø£Ø¯Ù…Ù†)
    function uploadToFirebase() {
        const t = document.getElementById('pTitle').value, d = document.getElementById('pDesc').value, ph = document.getElementById('pPhone').value;
        if(!t || tempImgs.length === 0) return alert("Ù†Ø§Ù‚Øµ!");
        db.collection("diablo_posts").add({ title: t, desc: d, phone: ph, imgs: tempImgs.map(i => i.src), time: Date.now() }).then(() => location.reload());
    }

    function loadCloudData() {
        db.collection("diablo_posts").orderBy("time", "desc").onSnapshot(snap => {
            const feed = document.getElementById('cloudFeed');
            feed.innerHTML = "";
            snap.forEach(doc => {
                const p = doc.data();
                feed.innerHTML += `
                    <div class="post-card">
                        ${isAdmin ? `<button onclick="deletePost('${doc.id}')" style="background:red; color:white; border:none; border-radius:5px; position:absolute; top:10px; left:10px; padding:5px; cursor:pointer;">Ø­Ø°Ù ğŸ—‘ï¸</button>` : ''}
                        <div class="img-slider">${p.imgs.map(i => `<img src="${i}">`).join('')}</div>
                        <h3>${p.title}</h3>
                        <p>${p.desc}</p>
                        ${p.phone ? `<a href="tel:${p.phone}" style="color:var(--p); font-weight:bold;">ğŸ“ Ø§ØªØµÙ„: ${p.phone}</a>` : ''}
                    </div>`;
            });
        });
    }

    function deletePost(id) { if(confirm("Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠØŸ")) db.collection("diablo_posts").doc(id).delete(); }

    function initApp(role) {
        document.getElementById('roleSelection').style.display = 'none';
        if(role === 'seller') document.getElementById('uploadArea').style.display = 'block';
    }

    function showInvestors() {
        document.getElementById('roleSelection').style.display = 'none';
        document.getElementById('cloudFeed').style.display = 'block';
    }

    function showPage(p) {
        document.querySelectorAll('.page-content').forEach(c => c.style.display='none');
        document.getElementById(p+'Page').style.display='block';
        toggleMenu();
    }

    function toggleMenu() {
        const m = document.getElementById('sideMenu');
        m.classList.toggle('active');
        document.getElementById('overlay').style.display = m.classList.contains('active') ? 'block' : 'none';
    }

    function toggleTheme() { document.body.classList.toggle('light-mode'); }
</script>
</body>
                                                                                   </html>
        
