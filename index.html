<!DOCTYPE html>
<html lang="ar" dir="rtl" id="diablo-app">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Diablo Hub | Pro & Secure Edition</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>

<style>
:root { --p: #ff4500; --bg: #050505; --card: #111; --t: #fff; --border: #222; }
.light-mode { --bg: #f5f5f5; --card: #fff; --t: #222; --border: #ddd; }
body { background: var(--bg); color: var(--t); font-family: 'Cairo', sans-serif; margin:0; padding-bottom:120px; transition:0.3s; }
header { padding:15px 5%; display:flex; justify-content:space-between; align-items:center; background:var(--card); border-bottom:1px solid var(--border); position:sticky; top:0; z-index:1000; gap:10px; }
.search-bar { flex:1; display:flex; background:var(--bg); border:1px solid var(--border); border-radius:20px; padding:5px 15px; }
.search-bar input { border:none; background:none; color:var(--t); outline:none; width:100%; font-size:14px; }
.categories { display:flex; overflow-x:auto; gap:10px; padding:10px 5%; white-space:nowrap; }
.cat-btn { background: var(--card); border:1px solid var(--border); color:var(--t); padding:8px 20px; border-radius:20px; cursor:pointer; font-size:13px; }
.cat-btn.active { background: var(--p); border-color: var(--p); color:white; }
.publish-btn-main { position:fixed; bottom:95px; left:50%; transform:translateX(-50%); width:60px; height:45px; background:linear-gradient(90deg,#00f2ea 0%,#ff0050 100%); border-radius:12px; display:flex; align-items:center; justify-content:center; z-index:4500; cursor:pointer; border:none; box-shadow:0 0 15px rgba(0,0,0,0.5);}
.publish-btn-main::after { content:'+'; color:black; font-size:30px; font-weight:bold; background:white; width:30px; height:30px; border-radius:5px; display:flex; align-items:center; justify-content:center;}
.publish-modal { position:fixed; inset:0; background:rgba(0,0,0,0.9); z-index:7000; display:none; align-items:center; justify-content:center; padding:20px; }
.modal-content { background: var(--card); width:100%; max-width:500px; border-radius:20px; padding:20px; position:relative; max-height:90vh; overflow-y:auto; }
.custom-file-upload { display:inline-block; padding:20px; background:#1a1a1a; border:2px dashed var(--p); border-radius:15px; cursor:pointer; text-align:center; width:100%; box-sizing:border-box; color:var(--p); }
.post-card { background: var(--card); border:1px solid var(--border); border-radius:15px; margin:0 5% 20px 5%; padding:15px; position:relative; border-right:4px solid var(--p); }
.price-tag { position:absolute; top:10px; left:10px; background:#25d366; color:white; padding:3px 12px; border-radius:20px; font-weight:bold; font-size:14px; }
#diablo-bot-icon { position:fixed; bottom:20px; left:20px; width:60px; height:60px; background:var(--p); border-radius:50%; display:flex; align-items:center; justify-content:center; z-index:5500; cursor:pointer; border:2px solid white; font-size:24px; }
#bot-chat-window { position:fixed; bottom:90px; left:20px; width:300px; height:400px; background:var(--card); border:1px solid var(--p); border-radius:15px; display:none; flex-direction:column; z-index:6000; }
.side-menu { position:fixed; top:0; right:-100%; width:280px; height:100%; background:var(--card); z-index:8000; transition:0.4s; padding:20px; overflow-y:auto; }
.side-menu.active { right:0; }
.overlay { position:fixed; inset:0; background:rgba(0,0,0,0.8); display:none; z-index:7500; }
.legal-page { display:none; padding:20px; line-height:1.6; }
.btn { background: var(--p); color:white; border:none; padding:12px; border-radius:8px; cursor:pointer; font-weight:bold; width:100%; margin-top:10px; }
input, textarea, select { width:100%; padding:12px; margin:8px 0; border-radius:8px; border:1px solid var(--border); background:var(--bg); color:var(--t); box-sizing:border-box; }
.ads-footer { position:fixed; bottom:0; left:0; width:100%; height:85px; background:#000; border-top:2px solid var(--p); display:flex; justify-content:space-around; align-items:center; z-index:4000; }

/* Ù„ÙˆÙ† Ø¬Ø°Ø§Ø¨ Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© */
.special-posts-btn { background: linear-gradient(90deg, #ffcc00, #ff7700); color: black; }
.special-posts-btn:hover { filter: brightness(1.2); }

</style>
</head>
<body>

<!-- Ø´Ø§Ø´Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø³ØªØ«Ù…Ø± / Ø§Ù„Ù…Ø§Ù„Ùƒ -->
<div id="startScreen" style="position:fixed; inset:0; background:var(--bg); z-index:9500; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; padding:20px;">
    <h1 style="color:var(--p)">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¯ÙŠØ§Ø¨Ù„Ùˆ Ù‡Ø¨</h1>
    <p>Ø§Ø®ØªØ± ØµÙØªÙƒ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©:</p>
    <button class="btn" style="max-width:300px;" onclick="setRole('investor')">Ø£Ù†Ø§ Ù…Ø³ØªØ«Ù…Ø± (Ø£Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù‚Ø§Ø±)</button>
    <button class="btn" style="max-width:300px; background:#222; border:1px solid var(--p);" onclick="setRole('seller')">Ø£Ù†Ø§ Ù…Ø§Ù„Ùƒ (Ø£Ø±ÙŠØ¯ Ø§Ù„Ù†Ø´Ø±)</button>
</div>

<!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
<header>
    <button onclick="toggleMenu()" style="background:none; border:none; color:var(--p); font-size:24px;">â˜°</button>
    <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø´Ù‚Ø©ØŒ ÙÙŠÙ„Ø§..." oninput="filterPosts()">
    </div>
    <button onclick="toggleTheme()" style="background:none; border:1px solid var(--p); color:var(--p); border-radius:20px; padding:4px 10px; font-size:12px;">MODE</button>
</header>

<!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
<div id="homePageContent">
    <div class="categories">
        <button class="cat-btn active" onclick="setCat('Ø§Ù„ÙƒÙ„')">Ø§Ù„ÙƒÙ„</button>
        <button class="cat-btn" onclick="setCat('Ø´Ù‚Ù‚')">ğŸ™ï¸ Ø´Ù‚Ù‚</button>
        <button class="cat-btn" onclick="setCat('ÙÙŠÙ„Ø§Øª')">ğŸ° ÙÙŠÙ„Ø§Øª</button>
        <button class="cat-btn" onclick="setCat('Ù…Ù†Ø§Ø²Ù„')">ğŸ¡ Ù…Ù†Ø§Ø²Ù„</button>
    </div>
    <div id="cloudFeed"></div>
</div>

<!-- ØµÙØ­Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ© -->
<div id="privacyPage" class="legal-page">
    <button class="btn" onclick="showPage('home')" style="width:auto;">âœ• Ø¥ØºÙ„Ø§Ù‚</button>
    <h2>ğŸ›¡ï¸ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</h2>
    <p>Ù†Ø­Ù† Ù†Ù„ØªØ²Ù… Ø¨Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ³ØªØ®Ø¯Ù… ÙÙ‚Ø· Ù„Ù„ØªÙˆØ§ØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø´ØªØ±ÙŠ ÙˆØ§Ù„Ø¨Ø§Ø¦Ø¹. Ù„Ø§ Ù†Ø´Ø§Ø±ÙƒÙ‡Ø§ Ù„Ø£Ø·Ø±Ø§Ù Ø«Ø§Ù„Ø«Ø©.</p>
</div>

<!-- Ø¥Ø®Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© -->
<div id="disclaimerPage" class="legal-page">
    <button class="btn" onclick="showPage('home')" style="width:auto;">âœ• Ø¥ØºÙ„Ø§Ù‚</button>
    <h2>âš ï¸ Ø¥Ø®Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©</h2>
    <p>Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ³ÙŠØ· ÙÙ‚Ø·. Ù†Ø­Ù† Ù„Ø§ Ù†ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø£Ùˆ Ù…ØµØ¯Ø§Ù‚ÙŠØ© Ø§Ù„Ù…Ø¹Ù„Ù†ÙŠÙ†. Ø£ÙŠ ØªØ¹Ø§Ù…Ù„Ø§Øª Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØªÙƒÙˆÙ† Ø¹Ù„Ù‰ Ù…Ø³Ø¤ÙˆÙ„ÙŠØªÙƒ.</p>
</div>

<!-- Ø§Ù„Ø´Ø±ÙˆØ· -->
<div id="termsPage" class="legal-page">
    <button class="btn" onclick="showPage('home')" style="width:auto;">âœ• Ø¥ØºÙ„Ø§Ù‚</button>
    <h2>âš–ï¸ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†</h2>
    <p>1. ÙŠÙ…Ù†Ø¹ Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ø¶Ù„Ù„Ø© Ø£Ùˆ ØµÙˆØ± ØºÙŠØ± Ù„Ø§Ø¦Ù‚Ø©.<br>2. ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ø¹Ù„Ù† ØµØ§Ø­Ø¨ Ø§Ù„Ø­Ù‚.<br>3. ÙŠØ­Ù‚ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© Ø­Ø°Ù Ø£ÙŠ Ù…Ù†Ø´ÙˆØ± Ù…Ø®Ø§Ù„Ù.</p>
</div>

<!-- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div id="authPage" class="legal-page" style="display:block; text-align:center;">
    <div style="max-width:400px; margin:auto; background:var(--card); padding:20px; border-radius:15px;">
        <h3 id="authStatus">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
        <input type="email" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
        <input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <button class="btn" onclick="handleAuth()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†</button>
    </div>
</div>

<!-- Ø²Ø± Ø§Ù„Ù†Ø´Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
<button class="publish-btn-main" id="mainPublishBtn" style="display:none;" onclick="togglePublishModal()"></button>

<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ù†Ø´Ø± -->
<div class="publish-modal" id="publishModal">
    <div class="modal-content">
        <h3 style="margin-top:0; color:var(--p)">Ù†Ø´Ø± Ù…Ù†Ø´ÙˆØ± Ø¬Ø¯ÙŠØ¯</h3>
        <select id="pType"><option value="Ø´Ù‚Ù‚">Ø´Ù‚Ø©</option><option value="ÙÙŠÙ„Ø§Øª">ÙÙŠÙ„Ø§</option><option value="Ù…Ù†Ø§Ø²Ù„">Ù…Ù†Ø²Ù„</option></select>
        <input type="text" id="pTitle" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†">
        <input type="number" id="pPrice" placeholder="Ø§Ù„Ø³Ø¹Ø±">
        <textarea id="pDesc" rows="4" placeholder="Ø§Ù„ØªÙØ§ØµÙŠÙ„"></textarea>
        <input type="tel" id="pPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
        <label class="custom-file-upload"><input type="file" id="pFiles" multiple accept="image/*" onchange="handleFiles(this.files)" style="display:none;">ğŸ“¸ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ±</label>
        <div id="preGrid" style="display:flex; gap:5px; margin:10px 0; overflow-x:auto;"></div>
        <div style="display:flex; gap:10px;"><button class="btn" onclick="uploadToFirebase()">Ù†Ø´Ø±</button><button class="btn" style="background:#444;" onclick="togglePublishModal()">Ø¥Ù„ØºØ§Ø¡</button></div>
    </div>
</div>

<!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
<div class="overlay" id="overlay" onclick="toggleMenu()"></div>
<div class="side-menu" id="sideMenu">
    <h3 style="color:var(--p)">DIABLO HUB</h3>
    <button class="btn" onclick="showPage('home'); toggleMenu()">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    <hr>
    <button class="btn special-posts-btn" onclick="showPage('specialPosts'); toggleMenu()">â­ Ù…Ù†Ø´ÙˆØ±Ø§Øª Ù…Ù…ÙŠØ²Ø©</button>
    <hr>
    <button class="btn" style="background:#222;" onclick="showPage('privacy'); toggleMenu()">ğŸ›¡ï¸ Ø§Ù„Ø®ØµÙˆØµÙŠØ©</button>
    <button class="btn" style="background:#222;" onclick="showPage('disclaimer'); toggleMenu()">âš ï¸ Ø¥Ø®Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©</button>
    <button class="btn" style="background:#222;" onclick="showPage('terms'); toggleMenu()">âš–ï¸ Ø§Ù„Ø´Ø±ÙˆØ·</button>
    <hr>
    <button class="btn" style="background:red;" onclick="auth.signOut().then(()=>location.reload())">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
</div>

<!-- ØµÙØ­Ø© Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© -->
<div id="specialPosts" class="legal-page">
    <button class="btn" onclick="showPage('home')" style="width:auto;">âœ• Ø¥ØºÙ„Ø§Ù‚</button>
    <h2 style="color:#ffbb00;">â­ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©</h2>
    <div id="specialPostsContainer"></div>
</div>

<!-- Ø¨ÙˆØª Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© -->
<div id="diablo-bot-icon" onclick="toggleChat()">ğŸ¤–</div>
<div id="bot-chat-window">
    <div style="background:var(--p); padding:10px; color:white; display:flex; justify-content:space-between;">
        <span>Ø¯ÙŠØ§Ø¨Ù„Ùˆ Ø¨ÙˆØª</span><span onclick="toggleChat()">âœ•</span>
    </div>
    <div id="chat-msgs" style="flex:1; padding:10px; overflow-y:auto; display:flex; flex-direction:column; gap:5px;"></div>
    <div style="display:flex; padding:5px; border-top:1px solid var(--border);">
        <input type="text" id="bot-input" style="flex:1; border:none; background:none; color:var(--t);" placeholder="Ø§Ø³Ø£Ù„Ù†ÙŠ...">
        <button onclick="sendToBot()" style="border:none; background:none; color:var(--p);">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>
</div>

<div class="ads-footer"></div>

<!-- Ø³ÙƒØ±ÙŠØ¨ØªØ§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
<script>
const firebaseConfig = {
    apiKey: "AIzaSyCGWNteBBsejx6UISfvnTY1YmnQeom7vNg",
    authDomain: "daiblosmart.firebaseapp.com",
    projectId: "daiblosmart",
    storageBucket: "daiblosmart.firebasestorage.app",
    messagingSenderId: "948075676362",
    appId: "1:948075676362:web:c27d582068712cbe13aa33"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();
let tempImgs=[], currentCat='Ø§Ù„ÙƒÙ„', currentUser=null, isAdmin=false;

// Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
auth.onAuthStateChanged(user=>{
    if(user){
        currentUser=user;
        if(user.email==="diablo@admin.com") isAdmin=true;
        document.getElementById('authPage').style.display='none';
        document.getElementById('startScreen').style.display='flex';
        loadCloudData();
    }
});

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
function handleAuth(){
    const e=document.getElementById('email').value, p=document.getElementById('pass').value;
    if(e==="diablo@admin.com" && p!=="3505Ilyas2008"){ alert("ÙƒÙ„Ù…Ø© Ø³Ø± Ø§Ù„Ø£Ø¯Ù…Ù† ØºÙŠØ± ØµØ­ÙŠØ­Ø©!"); return; }
    auth.signInWithEmailAndPassword(e,p).catch(()=>auth.createUserWithEmailAndPassword(e,p));
}

// ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¯ÙˆØ±
function setRole(role){
    document.getElementById('startScreen').style.display='none';
    document.getElementById('homePageContent').style.display='block';
    if(role==='seller') document.getElementById('mainPublishBtn').style.display='flex';
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
function loadCloudData(){
    db.collection("diablo_posts").orderBy("time","desc").onSnapshot(snap=>{
        const feed=document.getElementById('cloudFeed'); feed.innerHTML="";
        snap.forEach(doc=>{
            const p=doc.data();
            if(currentCat!=='Ø§Ù„ÙƒÙ„' && p.type!==currentCat) return;
            const showDelete=isAdmin || (currentUser && p.userId===currentUser.uid);
            feed.innerHTML+=`
            <div class="post-card">
                <span class="price-tag">${p.price}$</span>
                <div style="display:flex; overflow-x:auto; gap:10px;">${p.imgs.map(i=>`<img src="${i}" style="height:150px;border-radius:
